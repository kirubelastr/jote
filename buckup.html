<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spinning Wheel</title>
    <style>
        /* Style the popup */
        .popup {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            visibility: hidden;
            opacity: 0;
            transition: visibility 0s, opacity 0.5s;
        }
        .popup.active {
            visibility: visible;
            opacity: 1;
        }
        /* Style the wheels */
        .wheel {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            transition: left 1s, width 1s, height 1s;
        }
        .wheel.active {
            top: 20%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        /* Position the wheels in a row */
        #wheel1Div {
            top: 45%;
        }
        #wheel2Div {
            top: 55%;
        }
        #wheel3Div {
            top: 65%;
        }
    </style>
</head>

<body>
    <!-- Timer display -->
    <div id="timer" style="font-size: 20px; font-weight: bold;"></div>
<div class="container">
    <!-- The canvas for drawing the wheels -->
    <div id="wheel1Div" class="wheel">
        <canvas id="myCanvas1" width="100" height="120" style="border:1px solid #d3d3d3;">
            Your browser does not support the HTML5 canvas tag.
        </canvas>
    </div>
    <div id="wheel2Div" class="wheel">
        <canvas id="myCanvas2" width="100" height="120" style="border:1px solid #d3d3d3;">
            Your browser does not support the HTML5 canvas tag.
        </canvas>
    </div>
    <div id="wheel3Div" class="wheel">
        <canvas id="myCanvas3" width="100" height="120" style="border:1px solid #d3d3d3;">
            Your browser does not support the HTML5 canvas tag.
        </canvas>
    </div>
</div>
    

    <!-- Spin button -->
    <button id="spinButton" style="font-size: 20px; padding: 10px 20px;">Spin Fast!</button>
    <!-- Information display -->
    <div id="info"></div>
    <!-- Output displays for the wheels -->
    <input type="text" id="wheel1Output" readonly>
    <input type="text" id="wheel2Output" readonly>
    <input type="text" id="wheel3Output" readonly>

    <!-- The popup for displaying the result -->
    <div id="resultPopup" class="popup"></div>

    <script>
        // Get the canvas and its context
        var canvas1 = document.getElementById("myCanvas1");
        var ctx1 = canvas1.getContext("2d");
        var canvas2 = document.getElementById("myCanvas2");
        var ctx2 = canvas2.getContext("2d");
        var canvas3 = document.getElementById("myCanvas3");
        var ctx3 = canvas3.getContext("2d");

        // Get the popup
        var popup = document.getElementById("resultPopup");

        // Define the centers and radii of the wheels
        var centersX = [canvas1.width / 2, canvas2.width / 2, canvas3.width / 2];
        var centerY = [canvas1.height / 2, canvas2.height / 2, canvas3.height / 2];
        var radius = [canvas1.height / 3, canvas2.height / 3, canvas3.height / 2.5];

        // Define the colors and values of the sectors for each wheel
        var colors1 = ["#FF0000", "#00FF00", "#0000FF", "#FFFF00"];
        var colors2 = ["#FF0000", "#00FF00", "#0000FF", "#FFFF00"];
        var colors3 = ["#FF0000", "#00FF00", "#0000FF", "#FFFF00", "#FF00FF", "#00FFFF", "#FF0000", "#00FF00", "#0000FF", "#FFFF00", "#FF00FF", "#00FFFF", "#FF0000", "#00FF00", "#0000FF"];

        var values1 = ["Player 1", "Player 2", "Player 3", "Player 4"];
        var values2 = ["Order 1", "Order 2", "Order 3", "Order 4"];
        var values3 = ["Jote 1", "Jote 2", "Jote 3", "Jote 4", "Jote 5", "Jote 6", "Jote 7", "Jote 8", "Jote 9", "Jote 10", "Jote 11", "Jote 12", "Jote 13", "Jote 14", "Jote 15", "Jote 16", "Jote 17", "Jote 18", "Jote 19", "Jote 20", "Jote 21", "Jote 22"];

        // Group the colors and values for each wheel
        var colors = [colors1, colors2, colors3];
        var values = [values1, values2, values3];

        // Define the number of sectors for each wheel
        var numSectors = [values1.length, values2.length, values3.length];

        // Function to draw a sector of a wheel
        function drawSector1(centerX, startAngle, endAngle, color, value, radius) {
            ctx1.beginPath();
            ctx1.moveTo(centerX, centerY[0]);
            ctx1.arc(centerX, centerY[0], radius, startAngle, endAngle);
            ctx1.closePath();
            ctx1.fillStyle = color;
            ctx1.fill();

            // Draw the value in the middle of the sector
            var middleAngle = (startAngle + endAngle) / 2;
            ctx1.save();
            ctx1.translate(centerX, centerY[0]);
            ctx1.rotate(middleAngle);
            ctx1.textAlign = "center";
            ctx1.fillStyle = "#000000";
            ctx1.font = (30 * canvas1.width / 500) + "px Arial";
            ctx1.fillText(value, radius / 2, 0);
            ctx1.restore();
        }

        function drawSector2(centerX, startAngle, endAngle, color, value, radius) {
            ctx2.beginPath();
            ctx2.moveTo(centerX, centerY[1]);
            ctx2.arc(centerX, centerY[1], radius, startAngle, endAngle);
            ctx2.closePath();
            ctx2.fillStyle = color;
            ctx2.fill();

            // Draw the value in the middle of the sector
            var middleAngle = (startAngle + endAngle) / 2;
            ctx2.save();
            ctx2.translate(centerX, centerY[1]);
            ctx2.rotate(middleAngle);
            ctx2.textAlign = "center";
            ctx2.fillStyle = "#000000";
            ctx2.font = (30 * canvas2.width / 500) + "px Arial";
            ctx2.fillText(value, radius / 2, 0);
            ctx2.restore();
        }

        function drawSector3(centerX, startAngle, endAngle, color, value, radius) {
            ctx3.beginPath();
            ctx3.moveTo(centerX, centerY[2]);
            ctx3.arc(centerX, centerY[2], radius, startAngle, endAngle);
            ctx3.closePath();
            ctx3.fillStyle = color;
            ctx3.fill();

            // Draw the value in the middle of the sector
            var middleAngle = (startAngle + endAngle) / 2;
            ctx3.save();
            ctx3.translate(centerX, centerY[2]);
            ctx3.rotate(middleAngle);
            ctx3.textAlign = "center";
            ctx3.fillStyle = "#000000";
            ctx3.font = (30 * canvas3.width / 500) + "px Arial";
            ctx3.fillText(value, radius / 2, 0);
            ctx3.restore();
        }

        // Function to draw a pointer for a wheel
        function drawPointer1(centerX, radius) {
            ctx1.beginPath();
            ctx1.moveTo(centerX + radius - 20, centerY[0]);
            ctx1.lineTo(centerX + radius + 20, centerY[0] - 10);
            ctx1.lineTo(centerX + radius + 20, centerY[0] + 10);
            ctx1.closePath();
            ctx1.fillStyle = "#000000";
            ctx1.fill();
        }

        function drawPointer2(centerX, radius) {
            ctx2.beginPath();
            ctx2.moveTo(centerX + radius - 20, centerY[1]);
            ctx2.lineTo(centerX + radius + 20, centerY[1] - 10);
            ctx2.lineTo(centerX + radius + 20, centerY[1] + 10);
            ctx2.closePath();
            ctx2.fillStyle = "#000000";
            ctx2.fill();
        }

        function drawPointer3(centerX, radius) {
            ctx3.beginPath();
            ctx3.moveTo(centerX + radius - 20, centerY[2]);
            ctx3.lineTo(centerX + radius + 20, centerY[2] - 10);
            ctx3.lineTo(centerX + radius + 20, centerY[2] + 10);
            ctx3.closePath();
            ctx3.fillStyle = "#000000";
            ctx3.fill();
        }

        // Define the rotation speeds and angles for each wheel
        var rotationSpeeds = [0.01, 0.01, 0.01];
        var rotationAngles = [0, 0, 0];

        // Function to rotate a wheel
        function rotateWheel1() {
            ctx1.clearRect(0, 0, canvas1.width, canvas1.height);
            for (var j = 0; j < 1; j++) {
                ctx1.save();
                ctx1.translate(centersX[j], centerY[j]);
                ctx1.rotate(rotationAngles[j]);
                ctx1.translate(-centersX[j], -centerY[j]);

                for (var i = 0; i < numSectors[j]; i++) {
                    drawSector1(centersX[j], i * 2 * Math.PI / numSectors[j], (i + 1) * 2 * Math.PI / numSectors[j], colors[j][i], values[j][i], radius[j]);
                }

                ctx1.restore();
                drawPointer1(centersX[j], radius[j]);

                rotationAngles[j] += rotationSpeeds[j];
            }
        }

        function rotateWheel2() {
            ctx2.clearRect(0, 0, canvas2.width, canvas2.height);
            for (var j = 1; j < 2; j++) {
                ctx2.save();
                ctx2.translate(centersX[j], centerY[j]);
                ctx2.rotate(rotationAngles[j]);
                ctx2.translate(-centersX[j], -centerY[j]);

                for (var i = 0; i < numSectors[j]; i++) {
                    drawSector2(centersX[j], i * 2 * Math.PI / numSectors[j], (i + 1) * 2 * Math.PI / numSectors[j], colors[j][i], values[j][i], radius[j]);
                }

                ctx2.restore();
                drawPointer2(centersX[j], radius[j]);

                rotationAngles[j] += rotationSpeeds[j];
            }
        }

        function rotateWheel3() {
            ctx3.clearRect(0, 0, canvas3.width, canvas3.height);
            for (var j = 2; j < 3; j++) {
                ctx3.save();
                ctx3.translate(centersX[j], centerY[j]);
                ctx3.rotate(rotationAngles[j]);
                ctx3.translate(-centersX[j], -centerY[j]);

                for (var i = 0; i < numSectors[j]; i++) {
                    drawSector3(centersX[j], i * 2 * Math.PI / numSectors[j], (i + 1) * 2 * Math.PI / numSectors[j], colors[j][i], values[j][i], radius[j]);
                }

                ctx3.restore();
                drawPointer3(centersX[j], radius[j]);

                rotationAngles[j] += rotationSpeeds[j];
            }
        }

        // Function to start the wheels spinning
        function spinFast1() {
            document.getElementById("wheel1Div").classList.add("active");
            canvas1.width = 500;
            canvas1.height = 600;
            centersX[0] = canvas1.width / 2;
            centerY[0] = canvas1.height / 2;
            radius[0] = canvas1.height / 3;
            rotationSpeeds[0] = 0.1;
            setTimeout(function() {
                rotationSpeeds[0] = 0;
                var sector = Math.floor((rotationAngles[0] + Math.PI + Math.PI / 2) / (2 * Math.PI) * numSectors[0]) % numSectors[0];
                var result = values[0][sector];
                showResultPopup(1, colors[0][sector], result);
                setTimeout(function() {
                    document.getElementById("wheel1Div").classList.remove("active");
                    canvas1.width = 100;
                    canvas1.height = 120;
                    centersX[0] = canvas1.width / 2;
                    centerY[0] = canvas1.height / 2;
                    radius[0] = canvas1.height / 3;
                    var newValues = getValues(result);
                    values[1] = newValues[0];
                    values[2] = newValues[1];
                    numSectors[1] = values[1].length;
                    numSectors[2] = values[2].length;
                    spinFast2();
                }, 3000);
            }, 7000);
        }
        function getValues(result) {
                    var values2, values3;
                    if (result === "Player 1") {
                        values2 = ["oa", "ob", "oc", "od"];
                        values3 = ["a", "b", "c", "d", "e"];
                    } else if (result === "Player 2") {
                        values2 = ["oa", "ob", "oc", "od"];
                        values3 = ["a", "b", "c", "d", "e"];
                    } else if (result === "Player 3") {
                        values2 = ["oa", "ob", "oc", "od"];
                        values3 = ["a", "b", "c", "d", "e"];
                    } else { // result === "Player 4"
                        values2 = ["oa", "ob", "oc", "od"];
                        values3 = ["a", "b", "c", "d", "e"];
                    }
                    return [values2, values3];
                }

        function spinFast2() {
            document.getElementById("wheel2Div").classList.add("active");
            canvas2.width = 500;
            canvas2.height = 600;
            centersX[1] = canvas2.width / 2;
            centerY[1] = canvas2.height / 2;
            radius[1] = canvas2.height / 3;
            rotationSpeeds[1] = 0.1;
            setTimeout(function() {
                rotationSpeeds[1] = 0;
                var sector = Math.floor((rotationAngles[1] + Math.PI + Math.PI / 2) / (2 * Math.PI) * numSectors[1]) % numSectors[1];
                var result = values[1][sector];
                showResultPopup(2, colors[1][sector], result);
                setTimeout(function() {
                    document.getElementById("wheel2Div").classList.remove("active");
                    canvas2.width = 100;
                    canvas2.height = 120;
                    centersX[1] = canvas2.width / 2;
                    centerY[1] = canvas2.height / 2;
                    radius[1] = canvas2.height / 3;
                    spinFast3();
                }, 3000);
            }, 7000);
        }

        function spinFast3() {
    document.getElementById("wheel3Div").classList.add("active");
    canvas3.width = 500;
    canvas3.height = 600;
    centersX[2] = canvas3.width / 2;
    centerY[2] = canvas3.height / 2;
    radius[2] = canvas3.height / 2.5;
    rotationSpeeds[2] = 0.1;
    var extraTime = 1000; // Add extra time here
    setTimeout(function() {
        rotationSpeeds[2] = 0;
        var sector = Math.floor((rotationAngles[2] + Math.PI + Math.PI / 2) / (2 * Math.PI) * numSectors[2]) % numSectors[2];
        // Define forbidden sectors
        var forbiddenSectors = [0,1,2,3]; // change this to your forbidden sectors

        // Check if the sector is forbidden and adjust if necessary
        while (forbiddenSectors.includes(sector)) {
            sector = (sector + 1) % numSectors[2];
        }

        // Adjust the rotation angle to visually land on the selected sector
        rotationAngles[2] = ((sector + 0.5) * 2 * Math.PI / numSectors[2]) - Math.PI;

        var result = values[2][sector];
        showResultPopup(3, colors[2][sector], result);
        setTimeout(function() {
            popup.classList.remove("active");
            document.getElementById("wheel3Div").classList.remove("active");
            canvas3.width = 100;
            canvas3.height = 120;
            centersX[2] = canvas3.width / 2;
            centerY[2] = canvas3.height / 2;
            radius[2] = canvas3.height / 2.5;
        }, 5000 + extraTime);
    }, 7000 + extraTime);
}


        // Function to show the result in a popup
        function showResultPopup(wheelNumber, color, value) {
            popup.textContent = "Wheel " + wheelNumber + " result: " + value + " (" + color + ")";
            popup.classList.add("active");
        }

        // Add an event listener to the spin button
        document.getElementById("spinButton").addEventListener("click", spinFast1);

        // Start the animation
        setInterval(rotateWheel1, 1000 / 60); // 60 fps
        setInterval(rotateWheel2, 1000 / 60); // 60 fps
        setInterval(rotateWheel3, 1000 / 60); // 60 fps
    </script>
</body>

</html>
